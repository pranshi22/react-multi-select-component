var e=require("react");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=t(e);let a;const n={allItemsAreSelected:"All items are selected.",clearSearch:"Clear Search",clearSelected:"Clear Selected",noOptions:"No options",search:"Search",selectAll:"Select All",selectSomeItems:"Select...",create:"Create"},l={value:[],hasSelectAll:!0,className:"multi-select",debounceDuration:200,options:[]},o=r.default.createContext({}),s=({props:t,children:s})=>{const[c,i]=e.useState(t.options);return e.useMemo(()=>{"undefined"==typeof document||a||(a=document.createElement("style"),a.innerHTML=".rmsc{--rmsc-main:#4285f4;--rmsc-hover:#f1f3f5;--rmsc-selected:#e2e6ea;--rmsc-border:#ccc;--rmsc-gray:#aaa;--rmsc-bg:#fff;--rmsc-p:10px;--rmsc-radius:4px;--rmsc-h:38px}.rmsc *{box-sizing:border-box;transition:all .2s ease}.rmsc .gray{color:var(--rmsc-gray)}.rmsc .dropdown-content{padding-top:8px;position:absolute;top:100%;width:100%;z-index:1}.rmsc .dropdown-content .panel-content{background:var(--rmsc-bg);border-radius:var(--rmsc-radius);box-shadow:0 0 0 1px rgba(0,0,0,.1),0 4px 11px rgba(0,0,0,.1);overflow:hidden}.rmsc .dropdown-container{background-color:var(--rmsc-bg);border:1px solid var(--rmsc-border);border-radius:var(--rmsc-radius);outline:0;position:relative}.rmsc .dropdown-container[aria-disabled=true]:focus-within{border-color:var(--rmsc-gray);box-shadow:var(--rmsc-gray) 0 0 0 1px}.rmsc .dropdown-container:focus-within{border-color:var(--rmsc-main);box-shadow:var(--rmsc-main) 0 0 0 1px}.rmsc .dropdown-heading{align-items:center;cursor:default;display:flex;height:var(--rmsc-h);outline:0;padding:0 var(--rmsc-p);position:relative;width:100%}.rmsc .dropdown-heading .dropdown-heading-value{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.rmsc .clear-selected-button{background:none;border:0;cursor:pointer;display:flex;padding:0}.rmsc .options{margin:0;max-height:260px;overflow-y:auto;padding-left:0}.rmsc .options li{list-style:none;margin:0}.rmsc .select-item{box-sizing:border-box;cursor:pointer;display:block;outline:0;padding:var(--rmsc-p)}.rmsc .select-item:focus,.rmsc .select-item:hover{background:var(--rmsc-hover)}.rmsc .select-item.selected{background:var(--rmsc-selected)}.rmsc .no-options{color:var(--rmsc-gray);padding:var(--rmsc-p);text-align:center}.rmsc .search{border-bottom:1px solid var(--rmsc-border);position:relative;width:100%}.rmsc .search input{border:0;height:var(--rmsc-h);outline:0;padding:0 var(--rmsc-p);width:100%}.rmsc .search-clear-button{background:none;border:0;bottom:0;cursor:pointer;padding:0 calc(var(--rmsc-p)/2);position:absolute;right:0;top:0}.rmsc .search-clear-button [hidden]{display:none}.rmsc .item-renderer{align-items:baseline;display:flex}.rmsc .item-renderer input{margin:0 5px 0 0}.rmsc .item-renderer.disabled{opacity:.5}.rmsc .spinner{-webkit-animation:rotate 2s linear infinite;animation:rotate 2s linear infinite}.rmsc .spinner .path{stroke:var(--rmsc-border);stroke-width:4px;stroke-linecap:round;-webkit-animation:dash 1.5s ease-in-out infinite;animation:dash 1.5s ease-in-out infinite}@-webkit-keyframes rotate{to{transform:rotate(1turn)}}@keyframes rotate{to{transform:rotate(1turn)}}@-webkit-keyframes dash{0%{stroke-dasharray:1,150;stroke-dashoffset:0}50%{stroke-dasharray:90,150;stroke-dashoffset:-35}to{stroke-dasharray:90,150;stroke-dashoffset:-124}}@keyframes dash{0%{stroke-dasharray:1,150;stroke-dashoffset:0}50%{stroke-dasharray:90,150;stroke-dashoffset:-35}to{stroke-dasharray:90,150;stroke-dashoffset:-124}}",document.head.appendChild(a))},[]),e.useEffect(()=>{i(t.options)},[t.options]),r.default.createElement(o.Provider,{value:{t:e=>{var r;return(null==(r=t.overrideStrings)?void 0:r[e])||n[e]},...l,...t,options:c,setOptions:i}},s)},c=()=>r.default.useContext(o),i={when:!0,eventTypes:["keydown"]};function d(t,r,a){const n=e.useMemo(()=>Array.isArray(t)?t:[t],[t]),l=Object.assign({},i,a),{when:o,eventTypes:s}=l,c=e.useRef(r),{target:d}=l;e.useEffect(()=>{c.current=r});const u=e.useCallback(e=>{n.some(t=>e.key===t||e.code===t)&&c.current(e)},[n]);e.useEffect(()=>{if(o&&"undefined"!=typeof window){const e=d?d.current:window;return s.forEach(t=>{e&&e.addEventListener(t,u)}),()=>{s.forEach(t=>{e&&e.removeEventListener(t,u)})}}},[o,s,n,d,r])}const u={ARROW_DOWN:"ArrowDown",ARROW_UP:"ArrowUp",ENTER:"Enter",ESCAPE:"Escape",SPACE:"Space"};function m(e,t){const r=e.length,a=t.length,n=[];if(!r||!a)return 0;if(r<a&&([e,t]=[t,e]),-1!==e.indexOf(t))return a+1/r;for(let e=0;e<=r;++e)n[e]=[0];for(let e=0;e<=a;++e)n[0][e]=0;for(let l=1;l<=r;++l)for(let r=1;r<=a;++r)n[l][r]=e[l-1]===t[r-1]?1+n[l-1][r-1]:Math.max(n[l][r-1],n[l-1][r]);return n[r][a]}function f(e,t){if(!e)return"";if(e=e.toUpperCase().replace(/((?=[^\u00E0-\u00FC])\W)|_/g,""),!t)return e;const r=t;return Object.keys(r).reduce((e,t)=>{const a=new RegExp(t,"g");return e.replace(a,r[t])},e)}const p=()=>r.default.createElement("svg",{width:"24",height:"24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"dropdown-search-clear-icon gray"},r.default.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.default.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),h=({checked:e,option:t,onClick:a,disabled:n})=>r.default.createElement("div",{className:`item-renderer ${n&&"disabled"}`},r.default.createElement("input",{type:"checkbox",onChange:a,checked:e,tabIndex:-1,disabled:n}),r.default.createElement("span",null,t.label)),b=({itemRenderer:t=h,option:a,checked:n,tabIndex:l,disabled:o,onSelectionChanged:s,onClick:c})=>{const i=e.useRef(),m=()=>{o||s(!n)};return d([u.ENTER,u.SPACE],e=>{m(),e.preventDefault()},{target:i}),r.default.createElement("label",{className:`select-item ${n&&"selected"}`,role:"option","aria-selected":n,tabIndex:l,ref:i},r.default.createElement(t,{option:a,checked:n,onClick:e=>{m(),c(e)},disabled:o}))},v=({options:e,onClick:t,skipIndex:a})=>{const{disabled:n,value:l,onChange:o,ItemRenderer:s}=c();return r.default.createElement(r.default.Fragment,null,e.map((e,c)=>{const i=c+a;return r.default.createElement("li",{key:(null==e?void 0:e.key)||c},r.default.createElement(b,{tabIndex:i,option:e,onSelectionChanged:t=>{return r=e,void(n||o(t?[...l,r]:l.filter(e=>e.value!==r.value)));var r},checked:!!l.find(t=>t.value===e.value),onClick:e=>t(e,i),itemRenderer:s,disabled:e.disabled||n}))}))};var g;!function(e){e[e.SEARCH=0]="SEARCH",e[e.NONE=-1]="NONE"}(g||(g={}));const E=()=>{const{t:t,onChange:a,options:n,setOptions:l,value:o,filterOptions:s,selectAllLabel:i,ItemRenderer:h,disabled:E,disableSearch:x,hasSelectAll:k,ClearIcon:y,debounceDuration:w,isCreatable:C,onCreateOption:S}=c(),N=e.useRef(),R=e.useRef(),[A,O]=e.useState(""),[I,P]=e.useState(n),[M,W]=e.useState(""),[T,_]=e.useState(0),D=e.useCallback(((e,t)=>{let r;return function(){clearTimeout(r),r=setTimeout(()=>{e.apply(null,[].slice.call(arguments))},t)}})(e=>W(e),w),[]),L=e.useMemo(()=>{let e=0;return x||(e+=1),k&&(e+=1),e},[x,k]),$={label:i||t("selectAll"),value:""},j=()=>{var e;W(""),O(""),null==R||null==(e=R.current)||e.focus()},H=e=>_(e);d([u.ARROW_DOWN,u.ARROW_UP],e=>{switch(e.code){case u.ARROW_UP:F(-1);break;case u.ARROW_DOWN:F(1);break;default:return}e.stopPropagation(),e.preventDefault()},{target:N});const F=e=>{let t=T+e;t=Math.max(0,t),t=Math.min(t,n.length+Math.max(L-1,0)),_(t)};e.useEffect(()=>{var e,t;null==N||null==(e=N.current)||null==(t=e.querySelector(`[tabIndex='${T}']`))||t.focus()},[T]);const[U,z]=e.useMemo(()=>{const e=I.filter(e=>!e.disabled);return[e.every(e=>-1!==o.findIndex(t=>t.value===e.value)),0!==e.length]},[I,o]);return e.useEffect(()=>{(function(){try{return Promise.resolve(s?s(n,M):function(e,t,r){if(!t)return e;const a=f(t,r);return e.filter(({label:e,value:t})=>null!=e&&null!=t).map(e=>({option:e,score:m(f(e.label,r),a)})).filter(e=>e.score>=a.length-2).sort((e,t)=>t.score-e.score).map(e=>e.option)}(n,M))}catch(e){return Promise.reject(e)}})().then(P)},[M,n]),r.default.createElement("div",{className:"select-panel",role:"listbox",ref:N},!x&&r.default.createElement("div",{className:"search"},r.default.createElement("input",{placeholder:t("search"),type:"text","aria-describedby":t("search"),onChange:e=>{D(e.target.value),O(e.target.value),_(g.SEARCH)},onFocus:()=>{_(g.SEARCH)},value:A,ref:R,tabIndex:0}),r.default.createElement("button",{type:"button",className:"search-clear-button",hidden:!A,onClick:j,"aria-label":t("clearSearch")},y||r.default.createElement(p,null))),r.default.createElement("ul",{className:"options"},k&&z&&r.default.createElement(b,{tabIndex:1===L?0:1,checked:U,option:$,onSelectionChanged:e=>{const t=(e=>{const t=I.filter(e=>!e.disabled).map(e=>e.value);if(e){const e=[...o.map(e=>e.value),...t];return I.filter(t=>e.includes(t.value))}return o.filter(e=>!t.includes(e.value))})(e);a(t)},onClick:()=>H(1),itemRenderer:h,disabled:E}),I.length?r.default.createElement(v,{skipIndex:L,options:I,onClick:(e,t)=>H(t)}):C?r.default.createElement("li",{onClick:function(){try{function e(){l([t,...n]),j(),a([...o,t])}let t={label:A,value:A,__isNew__:!0};const r=function(){if(S)return Promise.resolve(S(A)).then(function(e){t=e})}();return Promise.resolve(r&&r.then?r.then(e):e())}catch(e){return Promise.reject(e)}},className:"select-item creatable"},`${t("create")} "${A}"`):r.default.createElement("li",{className:"no-options"},t("noOptions"))))},x=({expanded:e})=>r.default.createElement("svg",{width:"24",height:"24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"dropdown-heading-dropdown-arrow gray"},r.default.createElement("path",{d:e?"M18 15 12 9 6 15":"M6 9L12 15 18 9"})),k=()=>{const{t:e,value:t,options:a,valueRenderer:n}=c(),l=0===t.length,o=t.length===a.length,s=n&&n(t,a);return l?r.default.createElement("span",{className:"gray"},s||e("selectSomeItems")):r.default.createElement("span",null,s||(o?e("allItemsAreSelected"):t.map(e=>e.label).join(", ")))},y=({size:e=24})=>r.default.createElement("span",{style:{width:e,marginRight:"0.2rem"}},r.default.createElement("svg",{width:e,height:e,className:"spinner",viewBox:"0 0 50 50",style:{display:"inline",verticalAlign:"middle"}},r.default.createElement("circle",{cx:"25",cy:"25",r:"20",fill:"none",className:"path"}))),w=()=>{const{t:t,onMenuToggle:a,ArrowRenderer:n,shouldToggleOnHover:l,isLoading:o,disabled:s,onChange:i,labelledBy:m,value:f,isOpen:h,defaultIsOpen:b,ClearSelectedIcon:v,panelClassName:g,actionButtons:w=r.default.createElement(r.default.Fragment,null," ")}=c(),[C,S]=e.useState(!0),[N,R]=e.useState(b),[A,O]=e.useState(!1),I=n||x,P=e.useRef();!function(t,r){const n=e.useRef(!1);e.useEffect(()=>{n.current?a&&a(N):n.current=!0},r)}(0,[N]),e.useEffect(()=>{void 0===b&&"boolean"==typeof h&&(S(!1),R(h))},[h]),d([u.ENTER,u.ARROW_DOWN,u.SPACE,u.ESCAPE],e=>{var t;["text","button"].includes(e.target.type)&&[u.SPACE,u.ENTER].includes(e.code)||(C&&(e.code===u.ESCAPE?(R(!1),null==P||null==(t=P.current)||t.focus()):R(!0)),e.preventDefault())},{target:P});const M=e=>{C&&l&&R(e)};return r.default.createElement("div",{tabIndex:0,className:"dropdown-container","aria-labelledby":m,"aria-expanded":N,"aria-readonly":!0,"aria-disabled":s,ref:P,onFocus:()=>!A&&O(!0),onBlur:e=>{!e.currentTarget.contains(e.relatedTarget)&&C&&(O(!1),R(!1))},onMouseEnter:()=>M(!0),onMouseLeave:()=>M(!1)},r.default.createElement("div",{className:"dropdown-heading",onClick:()=>{C&&R(!o&&!s&&!N)}},r.default.createElement("div",{className:"dropdown-heading-value"},r.default.createElement(k,null)),o&&r.default.createElement(y,null),f.length>0&&r.default.createElement("button",{type:"button",className:"clear-selected-button",onClick:e=>{e.stopPropagation(),i([]),C&&R(!1)},disabled:s,"aria-label":t("clearSelected")},v||r.default.createElement(p,null)),r.default.createElement(I,{expanded:N})),N&&r.default.createElement("div",{className:"dropdown-content"},r.default.createElement("div",{className:`panel-content ${g}`},r.default.createElement(E,null),w)))};exports.Dropdown=w,exports.MultiSelect=e=>r.default.createElement(s,{props:e},r.default.createElement("div",{className:`rmsc ${e.className||"multi-select"}`},r.default.createElement(w,null))),exports.SelectItem=b,exports.SelectPanel=E;
